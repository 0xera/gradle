import java.util.concurrent.Executors
import java.util.concurrent.TimeUnit
import org.gradle.logging.StyledTextOutputFactory

task log << {
    def executor = Executors.newCachedThreadPool()
    (1..10).each { thread ->
        executor.execute {
            def textOut = services.get(StyledTextOutputFactory.class).create('build')
            (1..100).each { iteration ->
                logger.lifecycle("log message from thread $thread iteration $iteration")
                print "stdout message "
                println "from thread $thread iteration $iteration"
                textOut.text("styled text message from thread ")
                textOut.text(thread)
                textOut.text(' iteration ')
                textOut.text(iteration)
                textOut.endLine()
            }
        }
    }

    executor.shutdown()
    executor.awaitTermination(30, TimeUnit.SECONDS)
}

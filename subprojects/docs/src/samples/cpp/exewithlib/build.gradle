allprojects {
    apply plugin: 'cpp'
}

project(":lib") {
    cpp {
        binaries {
            main {
                spec {
                    sharedLibrary() // configure to build library
                }
            }
        }
    }
}

project(":exe") {
    cpp {
        sourceSets {
            main {
                headers {
                    // Include the headers from the lib project
                    srcDir project(":lib").cpp.sourceSets.main.headers
                }
            }
        }
        binaries {
            main {
                spec {
                    source project(":lib").cpp.binaries.main.spec
                }
            }
        }
    }
}

task build(dependsOn: project(":exe").compileMain)
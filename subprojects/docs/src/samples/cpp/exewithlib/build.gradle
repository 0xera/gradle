allprojects {
    apply plugin: 'cpp'
}

project(":lib") {
    nativ {
        binaries {
            main {
                spec {
                    sharedLibrary() // configure to build library
                }
            }
        }
    }
}

project(":exe") {
    nativ {
        sourceSets {
            main {
                headers {
                    // Include the headers from the lib project
                    srcDir project(":lib").nativ.sourceSets.main.headers
                }
            }
        }
        binaries {
            main {
                spec {
                    source project(":lib").nativ.binaries.main.spec
                }
            }
        }
    }
}

task build(dependsOn: project(":exe").compileMain)
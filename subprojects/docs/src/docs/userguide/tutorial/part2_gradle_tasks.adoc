// Copyright 2017 the original author or authors.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[part2_gradle_tasks]]
= Part 2: Explore and Run Gradle Tasks

Learn the basics of Gradle tasks by running one and looking at its output.

****
**In this section you will:**

- See available tasks
- Run a task and inspect the results
- Understand default and typed tasks
- Explore custom tasks
****

[[part2_begin]]
== Before you begin

1. Complete <<part1_gradle_init.adoc#part1_begin,part 1>>.

== Step 1. List Tasks
A _task_ is a piece of work that must be done by Gradle as part of the build.

In the `tutorial` directory, enter the command below to list all of the available tasks:
[source]
----
$ ./gradlew tasks
----

These are all of the Gradle tasks currently available to run in your project. It includes tasks contributed by the `application` plugin and the plugin it applies:

[source]
----
Application tasks
-----------------
run - Runs this project as a JVM application

Build tasks
-----------
assemble - Assembles the outputs of this project.
build - Assembles and tests this project.

...

Documentation tasks
-------------------
javadoc - Generates Javadoc API documentation for the main source code.

...

Other tasks
-----------
compileJava - Compiles main Java source.

...
----
Some of the available tasks assemble, run, compile code, and much more.
A task might be compiling some classes, storing class files into separate target folder, creating JAR files, generating Javadoc, or publishing artifacts to repositories.

You can also list the tasks only available in the `app` subproject by running `./gradlew :app:tasks`.

In <<part1_gradle_init.adoc#part1_begin,part 1>>, we ran the `build` task using the `./gradlew build` command.

== Step 2. Understanding Tasks
We've listed the tasks available when Gradle is initialized.
However, users can create custom tasks that perform some specific work.

Custom task code is typically available in the `build.gradle` file or it can come as part of a custom plugin which we will learn more about in <<part4_gradle_plugins#part4_begin,part 4>> of the tutorial.

Here is a example `Hello World` task:
[source]
----
task welcome {
    doLast {
        println('Welcome to the Gradle tutorial!')
    }
}
----

This custom task, if added to `build.gradle.kts` file in the `app` subproject directory, would be executed using the command `./gradlew :app:welcome`.

== Step 3. Task Ordering and Dependencies
Many times, a task requires another task to run first, especially if the task depends on the produced output of its dependency task.
A task may declare its dependencies explicitly.
A task may depend on other tasks implicitly.

Task execution order is automatically determined by Gradle, taking into account explicit dependencies and implicit dependencies.
If dependency is not available, Gradle enables users to request an execution order between tasks.

Here is an example of explicit task dependency:
[source]
----
task hello {
    println('Hello!')
}

task greet {
    println('How are you?')
}

greet.dependsOn(hello)
----

In this case, `hello` prints before `greet`: `Hello! How are you?`.

== Step 3. Tasks in the IDE
Let's take a look at all the tasks in IntelliJ.
The project should still be open following <<part1_gradle_init.adoc#part1_begin,part 1>>.

On the right hand side of your window, open the `Gradle` pane:

image::tutorial/intellij-idea-tasks.png[]

== Step 4. Run Tasks in the IDE
You can run a task in IntelliJ by double-clicking it in the pane.

Double-click **tutorial > app > build > build**.

image::tutorial/intellij-idea-build.png[]

It's important to make sure that the build was successful:
[source]
----
BUILD SUCCESSFUL in 966ms
7 actionable tasks: 7 executed
3:18:24 AM: Execution finished 'build'.
----

== Step 5. Run Tasks in the terminal
The `jar` default task can be used to create an executable JAR file of the App.

Run the following command in your terminal:
[source]
----
$ ./gradlew jar
----

A `app.jar` file is now available in your `tutorial/app/build/libs/` folder.

Invoke the `run` task and check the output:
[source]
----
$ ./gradlew run

> Task :app:run
Hello World!

BUILD SUCCESSFUL in 436ms
----

Take a moment and read the Java source code in `tutorial/app/src/main/java/com.gradle.tutorial/App.java`:
[source,java]
----
public class App {
    public String getGreeting() {
        return "Hello World!";
    }
    public static void main(String[] args) {
        System.out.println(new App().getGreeting());
    }
}
----
== Step 6. Typed Tasks
Custom and default Gradle tasks can be typed.
_Typed tasks_ are a subclass of the type link:{javadocPath}/org/gradle/api/Task.html[@Task].

This example shows a task of type `Copy`:
[source]
----
task copyTask(type: Copy) {
...
}
----

Here is another task of type `Delete`:
[source]
----
task clean(type: Delete) {
...
}
----

Popular tasks types include:

- **Copy** - `Copy` is useful to copy files around.
- **Delete** -  `Delete` is useful to delete files and directories.
- **Exec** - `Exec` is useful to execute arbitrary O/S commands.
- **Zip** - `Zip` is useful to bundle files.

Many more types are included in the DSL documentation.

[.text-right]
**Next Step:** <<part3_gradle_dep_man#part3_begin,About Gradle's Dependency Management>> >>

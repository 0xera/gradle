// Copyright 2017 the original author or authors.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[part1_gradle_init]]
= Part 1: Gradle Init

Learn the basics of Gradle by creating a App through the Gradle init.

In this section you will:

- Initialize a new Gradle project
- Build the project
- Open the project in IntelliJ IDE
- Explore Gradle files and build scripts
- Understand the Gradle wrapper

[[part1_begin]]
== Before you begin

1. Install link:https://jdk.java.net/[JDK 11 - JDK 17]. +
Find the installation on the link:https://www.oracle.com/java/technologies/downloads/[Oracle site] for your machine. You can install any SDK between 11 and 17. Do not install JDK 20.

2. Install link:https://www.jetbrains.com/idea/download/[IntelliJ IDE]. +
IDEA is the free version of IntelliJ.

3. Make sure you have <<installation.adoc#installation,Gradle installed>>. +
To test the Gradle installation, run Gradle from the command-line: +
[source]
----
$ gradle

Welcome to Gradle 8.0.2.

Directory '/' does not contain a Gradle build.

To create a new build in this directory, run gradle init
----

== 1. Run Gradle init
Once Gradle is installed, you can run `init` to initialize a new project with Gradle.

Create a new directory called `tutorial` and `cd` into it:
[source]
----
$ mkdir tutorial
$ cd tutorial
----

From the command-line run `gradle init` and continue with the prompt as indicated below:
[source]
----
$ gradle init

Select type of project to generate:
  1: basic
  2: application
  3: library
  4: Gradle plugin
Enter selection (default: basic) [1..4] 2

Select implementation language:
  1: C++
  2: Groovy
  3: Java
  4: Kotlin
  5: Scala
  6: Swift
Enter selection (default: Java) [1..6] 3

Split functionality across multiple subprojects?:
  1: no - only one application project
  2: yes - application and library projects
Enter selection (default: no - only one application project) [1..2] 1

Select build script DSL:
  1: Groovy
  2: Kotlin
Enter selection (default: Groovy) [1..2] 2

Generate build using new APIs and behavior (some features may change in the next minor release)? (default: no) [yes, no] no
Select test framework:
  1: JUnit 4
  2: TestNG
  3: Spock
  4: JUnit Jupiter
Enter selection (default: JUnit Jupiter) [1..4] 1

Project name (default: Tutorial): tutorial
Source package (default: tutorial): com.gradle.tutorial
----

Note that in this tutorial, Kotlin will be used to build a Java project.

When you are done, the directory should look as follows:

----
├── .gradle             // <1>
│   └── ⋮
├── gradle              // <2>
│   └── wrapper
├── gradlew             // <3>
├── gradlew.bat         // <4>
├── settings.gradle.kts // <5>
├── app                 // <6>
│   ├── build.gradle.kts
│   └── src
└── ⋮                   // <7>

----
<1> Project-specific cache directory generated by Gradle
<2> Contains the JAR file and configuration of the <<gradle_wrapper.adoc#gradle_wrapper,Gradle Wrapper>>
<3> OS X and Linux script for executing builds using the <<gradle_wrapper.adoc#gradle_wrapper,Gradle Wrapper>>
<4> Windows script for executing builds using the <<gradle_wrapper.adoc#gradle_wrapper,Gradle Wrapper>>
<5> The project's <<organizing_gradle_projects.adoc#sec:settings_file, settings file>> where the list of subprojects is defined
<6> The tutorial App Java source code and build configuration
<7> Some additional GIT files may be present such as `.gitignore`.

== 2. The Gradle Wrapper
In your newly created project, it is important to first take a look at the Gradle Wrapper (item +++<i class="conum" data-value="3"></i>+++ and +++<i class="conum" data-value="4"></i>+++ above).

The Gradle Wrapper is the preferred way of starting a Gradle build. It consists of a batch script for Windows +++<i class="conum" data-value="4"></i>+++ and a shell script for OS X and Linux +++<i class="conum" data-value="3"></i>+++. The Wrapper simply invokes a declared version of Gradle.

The wrapper script allow you to run a Gradle build without requiring that Gradle be installed on your system. From now on, you will never invoke gradle directly; instead you will use the gradle wrapper.

== 3. Use the Wrapper
Let's go ahead and use the wrapper by entering the following command:
[source]
----
$ ./gradlew build
----

The first time you run the wrapper, it downloads and caches the Gradle binaries if they are not already installed on your machine.

The Gradle Wrapper is designed to be committed to source control so that anyone can build the project without having to first install and configure a specific version of Gradle.

In this case, we invoked Gradle to build our tutorial project and we can see that the `app` directory now includes a new `build` folder:
[source]
----
$ cd app
$ ls -al
drwxr-xr-x  10 gradle-user  staff  320 May 24 18:07 build
-rw-r--r--   1 gradle-user  staff  862 May 24 17:45 build.gradle.kts
drwxr-xr-x   4 gradle-user  staff  128 May 24 17:45 src
----

We will look into this in detail in the next section.

== 4. Your App in the IDE
Open the tutorial project in IntelliJ IDEA by double-clicking on the `settings.gradle.kts` file in the `tutorial` directory:

image::tutorial/intellij-idea-ide.png[]

Take a moment to look around and open up the `settings.gradle.kts` and `build.gradle.kts` files in the IDE:

image::tutorial/intellij-idea-open.png[]

== 5. The Build script
The `build.gradle` file is the core component of the build process and has all of the instructions necessary to build the project.

The `build.gradle` file is read and executed by Gradle.

Each subproject contains its own `build.gradle` file. In this case our project only contains the `app` subproject.

Take a look at the build file in your `app` subproject (under the `app` directory):
[source]
----
plugins {
    // Apply the application plugin to add support for building a CLI application in Java.
    application
}

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
}

dependencies {
    // Use JUnit test framework.
    testImplementation("junit:junit:4.13.2")
        // This dependency is used by the application.
        implementation("com.google.guava:guava:31.1-jre")
}

application {
    // Define the main class for the application.
    mainClass.set("com.gradle.tutorial.App")
}
----

This build script lets Gradle know which dependencies and plugins the `app` subproject is using and where to find them. We will look at this in more detail in the following sections.

== 5. The Settings file
Gradle reads the `settings.gradle` file to figure out which subprojects are to take part in a project build.

Take a look at the file in your project:
[source]
----
rootProject.name = "tutorial"
include("app")
----

In this tutorial, the overall project is simple and only includes the `app` subproject.

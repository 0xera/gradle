plugins {
    id 'jvm-component'
    id 'java-lang'
}

<% if (repository) { %>
repositories {
    maven {
        url "${repository.getUri()}"
    }
}
<% } %>

configurations {
    compile
}

dependencies {
    <% if (dependencies) { dependencies.each { %>
    compile "${it.shortNotation()}"
    <% } } %>
}

model {
    components {
        main(JvmLibrarySpec)<% if (binding.hasVariable("generatedDependencies")) {
            def projectDependencies = generatedDependencies.get(subprojectNumber)
            if(projectDependencies) {
            %> {
            sources {
                java {
                    dependencies {<%
                        projectDependencies.each {
%>
                        project ':project${it}' library 'main'<%
                        } %>
                    }
                }
            }
        }
<% } } %>
        test(JvmLibrarySpec) {
            sources {
                java {
                    dependencies {
                        library 'main'
                    }
                }
            }
        }
    }
}

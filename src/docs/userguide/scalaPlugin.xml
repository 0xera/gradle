<!--
  ~ Copyright 2009 the original author or authors.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<chapter id="scala_plugin" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>The Scala Plugin</title>

    <para>The Scala Plugin extends the Java Plugin to add support for Scala projects. It can deal with Scala-only
        projects and with mixed Java/Scala projects. It can even deal with Java-only projects. Your project can have
        Scala classes which use Java classes, and vice versa.
    </para>

    <section>
        <title>Tasks</title>
        <para>The Scala plugin adds the following tasks to the project.</para>
        <table>
            <title>Scala plugin - tasks</title>
            <thead>
                <tr>
                    <td>Task name</td>
                    <td>Depends on</td>
                    <td>Type</td>
                </tr>
            </thead>
            <tr>
                <td><literal>compileScala</literal></td>
                <td><literal>compileJava</literal></td>
                <td><apilink class="org.gradle.api.tasks.scala.ScalaCompile"/></td>
            </tr>
            <tr>
                <td><literal>compileTestScala</literal></td>
                <td><literal>compileTestJava</literal></td>
                <td><apilink class="org.gradle.api.tasks.scala.ScalaCompile"/></td>
            </tr>
            <tr>
                <td><literal>compile<replaceable>SourceSet</replaceable>Scala</literal></td>
                <td><literal>compile<replaceable>SourceSet</replaceable>Java</literal></td>
                <td><apilink class="org.gradle.api.tasks.scala.ScalaCompile"/></td>
            </tr>
            <tr>
                <td><literal>scaladoc</literal></td>
                <td>-</td>
                <td><apilink class="org.gradle.api.tasks.scala.ScalaDoc"/></td>
            </tr>
        </table>
        <para>The Scala plugin adds the following dependencies to tasks added by the Java plugin.</para>
        <table>
            <title>Scala plugin - additional task dependencies</title>
            <thead>
                <td>Task name</td>
                <td>Depends on</td>
            </thead>
            <tr>
                <td>compile</td>
                <td>compileScala</td>
            </tr>
            <tr>
                <td>compileTest</td>
                <td>compileTestScala</td>
            </tr>
            <tr>
                <td>compile<replaceable>SourceSet</replaceable></td>
                <td>compile<replaceable>SourceSet</replaceable>Scala</td>
            </tr>
        </table>
        <figure>
            <title>Scala plugin - tasks</title>
            <imageobject>
                <imagedata fileref="images/scalaPluginTasks.png"/>
            </imageobject>
        </figure>
    </section>

    <section>
        <title>Project layout</title>
        <para>The Scala plugin assumes the project layout shown below.  All the Scala source directories can contain
            Scala <emphasis>and</emphasis> Java code. The Java source directories may only contain Java source code.
            None of these directories need exist or have anything in them. The Scala plugin will compile whatever it
            finds, and handles anything which is missing.</para>
        <table id='scalalayout'>
            <title>Scala plugin - project layout</title>
            <thead>
                <tr>
                    <td>Directory</td>
                    <td>Meaning</td>
                </tr>
            </thead>
            <xi:include href="javaProjectMainLayout.xml"/>
            <tr>
                <td>
                    <filename>src/main/scala</filename>
                </td>
                <td>Production Scala source. May also contain Java source for joint compilation.</td>
            </tr>
            <xi:include href="javaProjectTestLayout.xml"/>
            <tr>
                <td>
                    <filename>src/test/scala</filename>
                </td>
                <td>Test Scala source. May also contain Java source for joint compilation.</td>
            </tr>
            <xi:include href="javaProjectGenericLayout.xml"/>
            <tr>
                <td>
                    <filename>src/<replaceable>sourceSet</replaceable>/scala</filename>
                </td>
                <td>Scala source for the given source set. May also contain Java source for joint compilation.</td>
            </tr>
        </table>

        <section>
            <title>Changing the project layout</title>
            <para>TBD</para>
            <sample id="customScalaSourceLayout" dir="scala/customizedLayout" title="Custom Scala source layout">
                <sourcefile file="build.gradle" snippet="define-main"/>
            </sample>
        </section>

    </section>

    <section>
        <title>Dependency Management</title>
        <para>TBD</para>
    </section>

    <section>
        <title>Convention Properties</title>
        <para>The Scala plugin does not add any convention properties.</para>
    </section>
    
    <section>
        <title>Source set properties</title>
        <para>The Scala plugin adds a <apilink class="org.gradle.api.tasks.ScalaSourceSet"/> convention object to each source set.</para>
    </section>

</chapter>